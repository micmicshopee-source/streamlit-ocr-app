# Google 登入出現 403 錯誤排除

**錯誤訊息**：`403. That's an error. We're sorry, but you do not have access to this page.`

---

## 最常見原因：OAuth 同意畫面在「測試」模式

當您的 OAuth 應用處於 **「測試」** 狀態時，**只有已加入「測試使用者」的 Google 帳號**可以登入，其他帳號會看到 403。

### 解決方式一：加入測試使用者（建議）

1. 開啟 [Google Cloud Console](https://console.cloud.google.com/) → 選取您的專案。
2. 左側 **「API 和服務」** → **「OAuth 同意畫面」**。
3. 在 **「測試使用者」** 區塊點 **「新增使用者」**。
4. 輸入**您要用來登入的 Google 信箱**（例如 `your@gmail.com`），儲存。
5. 再次用該帳號點「以 Google 登入」即可。

### 解決方式二：正式發布應用（開放給任何人）

1. 同上進入 **「OAuth 同意畫面」**。
2. 若「發布狀態」為「測試中」，點 **「發布應用」**。
3. 確認後，任何有 Google 帳號的人都可以登入（若使用敏感範圍，可能需要通過 Google 驗證）。

---

## 其他可能原因

### 已授權的重新導向 URI 不符

- 在 **「API 和服務」→「憑證」→ 您的 OAuth 2.0 用戶端 ID** 裡，**「已授權的重新導向 URI」** 必須包含：
  - 本機：`http://localhost:8501/`（尾端斜線要一致）
- 本應用已將 `OAUTH_REDIRECT_URI = "http://localhost:8501/"` 寫入 `.streamlit/secrets.toml`，請確認 Console 內也有一模一樣的網址。

### 用戶端類型

- 須為 **「網頁應用程式」**，不是「桌面版應用程式」或「行動應用程式」。

---

**總結**：若 403 是在「選擇 Google 帳號」或「同意權限」那一步出現，九成是測試模式未加入該帳號為測試使用者，請依上方「解決方式一」加入即可。
