# 需求文檔（產品需求說明書）

**專案名稱**：上班族小工具（發票報帳・辦公小幫手）  
**文件版本**：v1.0  
**更新日期**：2026-01-29  
**適用對象**：產品、營運、測試、利害關係人

---

## 一、產品目標與定位

### 1.1 產品願景

為台灣上班族、行政與財務人員提供一站式的辦公小工具平台：以**發票報帳**為起點，逐步擴充 **AI 合約比對、AI 客服小秘、AI 會議精華**等工具，提升日常行政與報帳效率。

### 1.2 目標用戶

| 角色 | 說明 | 主要需求 |
|------|------|----------|
| 一般上班族 | 需自行整理發票、收據報帳 | 快速上傳、AI 辨識、導出報表 |
| 行政／會計人員 | 處理多筆發票、需分類與科目 | 批次導入、篩選、會計科目、PDF/CSV 導出 |
| 主管／PM | 需檢視合約差異、會議結論 | 合約比對、會議精華（規劃中） |
| 客服／業務 | 需回覆客戶、整理客訴 | AI 客服小秘（規劃中） |

### 1.3 使用情境

- 每月報帳：拍照或掃描發票 → 上傳 → AI 辨識 → 校正後導出 Excel/PDF 給會計。
- 既有資料整理：已有 Excel/CSV 發票清單 → 依模板導入 → 統一管理與導出。
- 一句話記帳：在 AI 報帳小助理輸入「今天午餐 120 元 全家」→ 自動產生一筆報帳草稿，確認後寫入。

---

## 二、功能需求總覽

### 2.1 功能模組與優先級

| 優先級 | 模組 | 說明 | 狀態 |
|--------|------|------|------|
| P0 | 登入／註冊／登出 | 多用戶隔離、台灣用語介面 | ✅ 已實現 |
| P0 | 發票報帳小秘笈 | OCR、導入、表格、總覽、導出、AI 小助理 | ✅ 已實現 |
| P1 | 小工具導航 | 左側選單切換工具、佔位頁 | ✅ 已實現 |
| P2 | AI 合約比對 | 上傳兩份合約、AI 標示差異與重點 | 規劃中 |
| P2 | AI 客服小秘 | 代擬回覆、整理客訴、常見問答建議 | 規劃中 |
| P2 | AI 會議精華 | 逐字稿/錄音轉文字、產出結論與待辦 | 規劃中 |
| P3 | Google 登入 | OAuth 登入 | 規劃中 |
| P3 | 其他辦公小工具 | 請購單整理、差旅費試算、預算對比等 | 待規劃 |

### 2.2 登入與帳號

- **登入方式**（台灣上線可用）  
  - 電子郵件 + 密碼（本站註冊）  
  - 忘記密碼（僅限本站註冊帳號）  
  - Streamlit Secrets（`USERS`）  
  - 環境變數 `USERS`  
  - Google 登入：介面預留，後端開發中  

- **註冊**  
  - 電子郵件格式驗證、密碼至少 6 字元、重複信箱檢查。  
  - 註冊成功後自動登入。  

- **多用戶隔離**  
  - 所有發票與報帳資料依 `user_email` 隔離，用戶僅能看見、編輯、導出、刪除自己的資料。  

- **介面與用語**  
  - 標題：「上班族小工具」；副標：「登入以使用發票報帳與更多辦公小幫手」。  
  - 全文使用台灣用語：登入、註冊、電子郵件、密碼、重設密碼、登出。  
  - 登入頁可顯示：「您的資料僅供您本人使用，我們不會分享給第三方。」  

### 2.3 發票報帳小秘笈（核心工具）

- **上傳與辨識**  
  - 支援上傳發票/收據圖片（JPG、PNG 等），以 Gemini AI 辨識：日期、發票號碼、賣方、統編、銷售額、稅額、總計等。  
  - 支援批次選擇多張圖片一次辨識。  

- **資料導入**  
  - 支援 CSV、Excel（.xlsx）批次導入。  
  - 提供導入模板下載，欄位含：檔案名稱、日期、發票號碼、賣方名稱、賣方統編、銷售額、稅額、總計、類型、會計科目等。  

- **資料表**  
  - 列表顯示當前用戶所有發票資料，支援篩選、編輯、單筆或批次刪除。  
  - 進階篩選：會計科目、類型、金額區間等。  
  - 刪除前需確認，避免誤刪。  

- **本期數據總覽**  
  - 本月總計、預計稅額、發票總數、缺失件數（四張指標卡）。  

- **導出**  
  - 導出 CSV、PDF；PDF 可填公司名稱與統編；僅導出當前用戶資料。  

- **AI 報帳小助理**  
  - 對話式介面：可詢問報帳、會計科目或操作方式。  
  - 支援一句話記帳（如「今天午餐 120 元 全家」），產出草稿經用戶確認後寫入。  
  - 需設定 Gemini API Key（側邊欄進階設定或 Secrets）。  

### 2.4 小工具導航與擴充

- **左側導航**  
  - 標題：「🛠️ 小工具」。  
  - 選單：📑 發票報帳小秘笈、⚖️ AI 合約比對、📧 AI 客服小秘、📅 AI 會議精華。  
  - 當前用戶（電子郵件）、登出按鈕。  
  - 進階設定（收合）：Gemini API Key、辨識模型。  

- **主內容切換**  
  - 選擇「發票報帳小秘笈」：顯示現有發票報帳完整功能。  
  - 選擇其他工具：顯示「此工具即將推出，敬請期待」佔位頁，並提示可先使用發票報帳。  

- **未來擴充**  
  - 新工具以相同模式加入左側選單與 `current_tool` 對應邏輯，必要時可拆成多頁或模組。  

---

## 三、用戶故事（精簡）

| ID | 角色 | 故事 | 驗收重點 |
|----|------|------|----------|
| U1 | 上班族 | 我想用電子郵件和密碼登入，只看到自己的發票 | 登入後資料依帳號隔離 |
| U2 | 上班族 | 我想註冊新帳號並馬上開始使用 | 註冊成功後自動登入 |
| U3 | 行政 | 我想上傳多張發票照片一次辨識 | 批次 OCR、結果寫入列表 |
| U4 | 行政 | 我想把現有 Excel 發票清單導入 | CSV/Excel 導入、模板下載 |
| U5 | 會計 | 我想依會計科目篩選並導出 PDF | 進階篩選、PDF 含公司資訊 |
| U6 | 上班族 | 我想用一句話記一筆支出 | AI 小助理解析 → 草稿確認 → 寫入 |
| U7 | 所有人 | 我想在左側切換不同小工具 | 發票報帳可用、其餘顯示即將推出 |
| U8 | 所有人 | 我忘記密碼時想重設 | 僅本站註冊帳號可重設、流程明確 |

---

## 四、驗收標準（Acceptance Criteria）

### 4.1 登入／註冊

- 未登入時僅顯示登入頁，無法進入主應用。  
- 電子郵件格式錯誤時顯示明確錯誤訊息。  
- 密碼少於 6 字元時註冊/重設失敗並提示。  
- 註冊成功後自動登入並跳轉主畫面。  
- 登入成功後 `st.session_state.authenticated` 與 `user_email` 正確設定。  
- 登出後清除登入狀態，回到登入頁。  

### 4.2 發票報帳

- 上傳圖片後可選擇「開始辨識」，呼叫 Gemini 並將結果寫入當前用戶資料。  
- 導入 CSV/Excel 後資料正確寫入且歸屬當前用戶。  
- 列表僅顯示當前用戶資料；編輯、刪除、導出僅作用於當前用戶。  
- 導出 CSV/PDF 時僅包含當前用戶資料，PDF 可填公司名稱與統編。  
- AI 報帳小助理在設定 API Key 後可對話，一句話記帳可產出草稿並確認寫入。  

### 4.3 小工具導航

- 左側顯示四項小工具選單，預設為「發票報帳小秘笈」。  
- 切換到「AI 合約比對／客服小秘／會議精華」時，主區顯示即將推出佔位頁。  
- 進階設定收合後可設定 API Key 與模型，設定後發票辨識與 AI 小助理使用該設定。  

### 4.4 非功能

- 介面文案使用台灣用語（登入、電子郵件等）。  
- 敏感資訊（API Key、密碼）不以明文顯示於日誌或前端。  

---

## 五、非功能需求

| 類型 | 說明 |
|------|------|
| 可用性 | 主要流程（登入→上傳/導入→辨識/編輯→導出）無需手冊即可完成。 |
| 效能 | 單次 OCR 與列表載入在合理時間內完成（依 API 與資料量）。 |
| 資料隔離 | 所有發票與用戶資料依 `user_email` 隔離，無跨用戶存取。 |
| 相容性 | 支援常見瀏覽器（Chrome、Edge、Safari 等）；響應式版面。 |
| 在地化 | 台灣正體中文、台灣用語與數字/日期格式。 |

---

## 六、規劃中的功能（簡述）

- **AI 合約比對**：上傳兩份合約/條款，AI 標示差異與重點。  
- **AI 客服小秘**：代擬回覆、整理客訴重點、常見問答建議。  
- **AI 會議精華**：上傳逐字稿或錄音轉文字，產出結論與待辦。  
- **Google 登入**：OAuth 整合，按鈕已存在。  
- **其他辦公小工具**：請購/報價單整理、差旅費試算、預算 vs 實際、檔案命名、收發文登記、零用金結算等（見《台灣上線檢查與規劃》）。  

---

## 七、名詞與用語規範

- **登入**（不使用「登錄」）  
- **電子郵件**（可接受「信箱」於口語說明）  
- **密碼、註冊、重設密碼、登出**  
- **發票、收據、報帳、導出、辨識、導入**  
- **小工具、進階設定、當前用戶**  

以上為需求文檔之核心內容，可依產品迭代增修章節與優先級。
