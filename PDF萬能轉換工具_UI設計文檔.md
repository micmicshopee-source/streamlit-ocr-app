# PDF 萬能轉換工具 — UI 設計文檔

**版本**：v1.0  
**更新日期**：2025-02  
**對象**：產品、設計、前端開發

**參考**：`PDF萬能轉換工具_iLovePDF參考分析.md`、[iLovePDF](https://www.ilovepdf.com/zh-tw)

---

## 一、設計目標

### 1.1 核心原則

- **單一明確**：每次操作只做一種轉換，降低認知負擔
- **流程簡短**：上傳 → 選擇 → 轉換 → 下載，四步完成
- **即時反饋**：進度條、成功/失敗訊息、預覽（如有）

### 1.2 目標用戶

- 上班族：報表、簡報、合約等格式轉換
- 需求：快速、無需註冊、本地處理（隱私）

---

## 二、資訊架構

### 2.1 功能分類（參考 iLovePDF）

```
PDF 萬能轉換工具
│
├── 從 PDF 轉換（PDF → 其他）
│   ├── PDF → Excel
│   ├── PDF → Word          [含 AI OCR 選項]
│   ├── PDF → PowerPoint
│   ├── PDF → 圖片 (ZIP)    [PNG / JPG 選項]
│   └── (規劃) PDF → PDF/A
│
└── 轉換為 PDF（其他 → PDF）
    ├── (規劃) JPG → PDF
    ├── (規劃) Word → PDF
    ├── (規劃) Excel → PDF
    ├── (規劃) PPT → PDF
    └── (規劃) HTML → PDF
```

### 2.2 導航層級

- **第一層**：側邊欄「📄 PDF 萬能轉換工具」
- **第二層**：工具內「轉換方向」切換（從 PDF 轉換 / 轉換為 PDF）
- **第三層**：單一轉換類型（選單或卡片）

---

## 三、頁面佈局

### 3.1 現有佈局（app.py）

```
┌─────────────────────────────────────────────────────────┐
│ 📄 PDF 萬能轉換工具                                       │
│ 支援 PDF 轉 Excel、PPT、圖片 (JPG/PNG)、Word。上傳 PDF 後選擇轉換目標格式。 │
├─────────────────────────────────────────────────────────┤
│ [上傳 PDF 檔案]  ← file_uploader                          │
│                                                          │
│ 轉換目標 [Excel (.xlsx) ▼]  ← selectbox                   │
│                                                          │
│ (若選圖片) 圖片格式 ○ PNG  ○ JPG                          │
│ (若選 Word) ☐ 使用 AI OCR（適用掃描檔，需 API 金鑰）        │
│                                                          │
│ [開始轉換]  ← primary button                              │
│                                                          │
│ (轉換後) 進度條 → 成功訊息 → 預覽(圖片) → 下載按鈕          │
└─────────────────────────────────────────────────────────┘
```

### 3.2 建議優化佈局（雙向分類）

```
┌─────────────────────────────────────────────────────────┐
│ 📄 PDF 萬能轉換工具                                       │
│ 支援 PDF 與 Office、圖片格式互轉。                         │
├─────────────────────────────────────────────────────────┤
│ 轉換方向  ○ 從 PDF 轉換  ○ 轉換為 PDF                     │
├─────────────────────────────────────────────────────────┤
│ 【從 PDF 轉換】                                           │
│ 轉換目標 [Excel (.xlsx) ▼]                                │
│ [上傳 PDF 檔案]                                           │
│                                                          │
│ 【轉換為 PDF】                                            │
│ 來源格式 [JPG/PNG 圖片 ▼]                                 │
│ [上傳圖片檔案]（可多選）                                   │
├─────────────────────────────────────────────────────────┤
│ [開始轉換]                                                │
│ (結果區)                                                  │
└─────────────────────────────────────────────────────────┘
```

---

## 四、元件規格

### 4.1 上傳區

| 元件 | 規格 | 說明 |
|------|------|------|
| 檔案類型 | `type=["pdf"]` 或依模式 | 限制副檔名，避免錯誤上傳 |
| 大小提示 | 超過 50MB 顯示 warning | 避免記憶體過載 |
| 多檔 | 僅「轉換為 PDF」模式可考慮 | 多張 JPG → 單一 PDF |

### 4.2 選項區

| 選項 | 類型 | 預設 | 說明 |
|------|------|------|------|
| 轉換目標 | selectbox | Excel | 依「從 PDF 轉換」顯示 |
| 圖片格式 | radio | PNG | 僅在「PDF → 圖片」時顯示 |
| AI OCR | checkbox | 未勾選 | 僅在「PDF → Word」時顯示，需 API 金鑰 |

### 4.3 操作按鈕

| 按鈕 | 樣式 | 位置 |
|------|------|------|
| 開始轉換 | `type="primary"` | 選項區下方 |
| 下載 Excel/PPT/Word/ZIP | `st.download_button` | 轉換成功後 |

### 4.4 反饋元件

| 情境 | 元件 | 文案 |
|------|------|------|
| 未上傳 | `st.info` | 「👆 請先上傳 PDF 檔案」 |
| 轉換中 | `st.progress` + `st.spinner` | 「轉換中，請稍候…」 |
| 成功 | `st.success` | 「轉換完成」 |
| 失敗 | `st.error` | 錯誤訊息（含依賴提示） |
| 預覽 | `st.image` | 僅「PDF → 圖片」顯示第一頁 |

---

## 五、互動流程

### 5.1 從 PDF 轉換流程

```
1. 進入工具 → 選擇「從 PDF 轉換」
2. 選擇轉換目標（Excel / Word / PPT / 圖片）
3. 若選 Word → 可勾選 AI OCR
4. 若選圖片 → 選擇 PNG 或 JPG
5. 上傳 PDF
6. 點擊「開始轉換」
7. 等待進度條完成
8. 成功 → 下載按鈕；失敗 → 錯誤訊息
```

### 5.2 轉換為 PDF 流程（規劃）

```
1. 選擇「轉換為 PDF」
2. 選擇來源格式（JPG / Word / Excel / PPT）
3. 上傳對應類型檔案（可多檔，僅圖片）
4. 點擊「開始轉換」
5. 下載 PDF
```

---

## 六、視覺風格

### 6.1 與主應用一致

- 使用 `premium_dark.css` 深色主題
- 標題：`st.subheader`「📄 PDF 萬能轉換工具」
- 說明：`st.caption` 一行簡述
- 按鈕：`type="primary"` 主操作

### 6.2 卡片式選項（可選）

參考 iLovePDF 首頁，可將轉換類型改為卡片：

```
┌─────────────┐ ┌─────────────┐ ┌─────────────┐
│ 📊 Excel    │ │ 📝 Word     │ │ 📽 PPT      │
│ PDF → 表格  │ │ PDF → 文檔  │ │ PDF → 簡報  │
└─────────────┘ └─────────────┘ └─────────────┘
```

Streamlit 可用 `st.columns` + `st.markdown` 或 `st.button` 模擬點擊選卡片。

---

## 七、錯誤與邊界情境

| 情境 | 處理方式 |
|------|----------|
| 未上傳即點轉換 | 按鈕可點，但上傳區為空時應 `st.stop()` 或 disable |
| 加密 PDF | 顯示「PDF 已加密或受密碼保護，無法讀取」 |
| 無 poppler | 顯示安裝指引（含 poppler-utils） |
| 無 pdf2docx | 顯示「請執行 pip install pdf2docx」；Word 可建議改用 AI OCR |
| AI OCR 無金鑰 | 顯示「請在進階設定中設定 GEMINI_API_KEY」 |
| 大檔 (>50MB) | 顯示 warning，仍允許轉換（或可改為硬阻擋） |

---

## 八、響應式與無障礙

- Streamlit 預設響應式，`st.columns` 可自適應
- 按鈕與選項需有明確標籤，避免僅依圖示
- 錯誤訊息需具體可操作（如「請執行 pip install xxx」）

---

*文件建立日期：2025-02*
