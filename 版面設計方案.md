# 發票報帳小秘笈 — 版面設計方案

## 一、目前結構（問題點）

主內容區由上到下大致是：

| 順序 | 區塊 | 問題 |
|------|------|------|
| 1 | **Hero**：大標「發票收據報帳小秘笈 Pro」+ 副標 + 三按鈕（上傳發票圖、CSV導入、AI 助理） | 標題與下方「發票報帳」重複感；按鈕與功能分散 |
| 2 | **統計 KPI**：綠點 +「發票報帳」+ 本月份 pill + 四張 KPI 卡片 | 與 Hero 語意重疊；和「發票明細」之間距離過遠 |
| 3 | **發票對獎**：雙欄（對獎結果／開獎號碼） | 插在「總覽→圖表→明細」中間，打斷主流程；對獎是附加功能卻佔很大版面 |
| 4 | **分析圖表**：三欄（會計科目、每日趨勢、類型分布） | 與「發票明細」沒有明確從屬關係，層級扁平 |
| 5 | **篩選 + 表格區**：搜尋、日期、狀態、會計科目、類型、金額篩選 | 篩選與「發票明細與編輯」分兩塊，中間隔了長邏輯，視覺上不連貫 |
| 6 | **發票明細與編輯**：按組／按單張、操作鈕、可編輯表格 | 主操作區，但標題與上方「數據表格區」界線模糊 |

整體問題摘要：

- **主流程不清晰**：總覽 → 圖表 → 篩選與明細，應一氣呵成；對獎、上傳等應收斂為「入口」或「次要區」。
- **標題與語意重複**：Hero 標題、「發票報帳」報表標、「發票明細與編輯」多層標題，角色不清。
- **區塊層級扁平**：圖表與明細同級，沒有「先看圖、再操作表」的層次。
- **篩選與明細分離**：篩選在一個 container、明細在另一個 subheader 下，閱讀與操作被切開。

---

## 二、設計目標

1. **單一主流程**：總覽（KPI）→ 圖表（分析）→ 篩選與明細（操作），由上而下一次看完、一次操作。
2. **標題階層清楚**：一個頁面主標 + 少數區塊標，其餘用說明或無標。
3. **次要功能收斂**：對獎、上傳、AI 助理不搶主視覺，以入口按鈕或收合區呈現。
4. **視覺分組**：用間距、分隔線或卡片感把「總覽 / 圖表 / 明細」三塊分組，不亂不擠。

---

## 三、建議版面結構（由上而下）

### 1. 頂部：單一標題 + 主操作入口（收斂 Hero）

- **主標**：一個標題即可，例如「發票報帳」或保留「發票收據報帳小秘笈」。
- **副標**：一句話說明用途（例如「上傳辨識、導入、報表導出」）。
- **操作入口**：同一行或緊接一行，三個按鈕並排：「上傳發票圖」「CSV／Excel 導入」「AI 報帳小助理」。
- **不再重複**「發票報帳」綠點標；KPI 區直接接在下面，不再多一個大標。

效果：頂部簡短、入口明確，不與 KPI 區標題打架。

---

### 2. 總覽區（KPI）

- 維持現有：左側「發票報帳」小標 + 說明一句，右側「本月份」pill。
- 四張 KPI 卡片不變（本月總計、預計稅額、發票總數、缺失件數）。
- 與頂部之間留一組間距（例如 8px/16px），與下方圖表區也留一組間距，形成一塊「總覽卡片」感（可選：加淺底或細線）。

---

### 3. 分析圖表區

- 區塊標題：**「分析圖表」**（或「圖表」即可），不再加冗長說明。
- 三欄圖表維持：會計科目、每日支出趨勢、類型分布。
- 無數據時一句提示即可。
- 與總覽區、與下方「發票明細」之間都用固定間距分開，讓「總覽 → 圖表 → 明細」三塊清楚分組。

---

### 4. 發票明細與操作（合併為一大塊）

- **單一區塊標題**：**「發票明細」**（或「發票明細與編輯」）。
- **篩選與操作同一區**：
  - 第一行：搜尋框 + 日期區間 + 狀態／會計科目／類型（可收合或精簡為一列）。
  - 第二行：篩選說明（若有）與操作按鈕列（刪除、CSV、Excel、PDF）— 按單張視圖時顯示。
- **視圖切換**：按組／按單張 Tab 或 radio，緊接在篩選下方。
- **表格**：按組時為群組列表；按單張時為可編輯表格，操作鈕在表格上方（已實作）。

效果：篩選、視圖、操作鈕、表格都在「發票明細」這一個大標下，邏輯與視覺都連貫。

---

### 5. 發票對獎（收斂為次要區）

- **位置**：建議移到「發票明細」區塊**下方**，或放在側邊欄「進階設定」旁的「發票對獎」收合區。
- **若保留在主內容**：改為一個 **expander**「發票對獎」，預設收合；點開再顯示雙欄（對獎結果 + 開獎號碼）。這樣主流程不被中斷，對獎仍可用。

---

## 四、順序對照（建議前後）

| 建議順序 | 區塊 | 說明 |
|----------|------|------|
| 1 | 頂部標題 + 三按鈕（上傳／導入／AI 助理） | 收斂 Hero，只保留一個主標 |
| 2 | 總覽 KPI（發票報帳 + 四張卡） | 維持現有樣式，與頂部間距分開 |
| 3 | 分析圖表（三欄） | 標題簡化為「分析圖表」或「圖表」 |
| 4 | 發票明細（篩選 + 視圖切換 + 操作鈕 + 表格） | 篩選與明細合併為一大區 |
| 5 | 發票對獎（expander 或移至側欄） | 不插在主流程中間 |

---

## 五、實作時可調的細節

- **間距**：總覽與圖表之間、圖表與明細之間，用 `st.container()` + CSS 或 `st.markdown("---")` 做視覺分隔。
- **標題階層**：頂部用 `st.title`，區塊用 `st.subheader`，區塊內小標用 `st.markdown("**小標**")` 或現有 class。
- **側邊欄**：發票對獎若改到側欄，可放在「進階設定」下方，用 expander「發票對獎」包住，避免主內容過長。

若你同意這套順序與分組，我可以依此在 `app.py` 裡調整區塊順序與標題，並把對獎改為 expander 或側欄選項。
