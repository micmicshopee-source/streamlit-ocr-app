# 發票對獎：手動輸入與開獎號碼展示方案

## 一、手動輸入開獎號碼：是否需要？

### 1.1 保留的理由

| 情境 | 說明 |
|------|------|
| **自動取得失敗** | 財政部改版、網路異常、防爬時，自動取得會失敗，手動貼上是唯一備援。 |
| **歷史期別** | 目前自動只支援「最新一期」「上一期」；若要對更早的期別（如半年前），只能手動貼上該期頁面內容。 |
| **離線／內網** | 若 App 部署在無法連外網的環境，無法呼叫財政部網址，只能靠使用者從別處複製貼上。 |

### 1.2 移除或弱化的理由

| 情境 | 說明 |
|------|------|
| **多數人用不到** | 一般使用者只對「最新一期」或「上一期」，一鍵對獎即可，很少需要手動。 |
| **減少干擾** | 區塊一多，版面容易顯得雜，初學者容易困惑「要選哪一個」。 |
| **維護成本** | 手動解析邏輯要隨財政部頁面文字格式調整，多一個入口就多一處要測。 |

### 1.3 建議結論

- **建議：保留，但收合**  
  - 保留「手動輸入開獎號碼」作為**備援**，預設收合在 expander，不干擾主流程。  
  - 文案可改為「**手動貼上開獎號碼（備用）**」，說明寫：「當自動取得失敗或要對更早期別時使用。」  
- **若產品定位為「僅支援最新兩期」**：可改為只顯示「自動取得失敗時，請至 [財政部開獎頁](連結) 複製整頁貼上」提示，不提供手動解析按鈕；但多數情況仍建議保留收合的手動區塊，以兼顧異常與歷史期別。

---

## 二、本期開獎號碼：是否應該展示？

### 2.1 展示的優點

| 優點 | 說明 |
|------|------|
| **對帳與信任** | 使用者可對照「系統用的開獎號碼」與財政部公告是否一致，減少疑慮。 |
| **一次看清** | 不用再開財政部頁面，在 App 內就能確認本期特別獎、特獎、頭獎。 |
| **領獎與分享** | 領獎前可再確認號碼；若需轉貼給他人，可直接從畫面複製。 |

### 2.2 不展示／收合的優點

| 優點 | 說明 |
|------|------|
| **版面簡潔** | 多數人只關心「有沒有中獎、中多少」，不一定要看完整開獎號碼。 |
| **減少干擾** | 結果區以「對獎結果」為主，開獎號碼屬補充資訊。 |

### 2.3 建議結論

- **建議：本期開獎號碼「應展示」，且以「對獎後直接顯示」為主**  
  - **理由**：對獎結果是依這些號碼算出來的，展示開獎號碼有助於對帳與信任，且資訊量不大（一行特別獎／特獎／頭獎 + 領獎期間）。  
  - **方式**：  
    - **方案 A（推薦）**：對獎完成後，在**對獎結果摘要下方**直接顯示一小塊「本期開獎號碼」：特別獎、特獎、頭獎、領獎期限，不收入 expander。  
    - **方案 B**：維持在 expander「查看本期開獎號碼」內，但**預設展開**（expanded=True），讓有跑過對獎的人一進來就看到。  
  - 若希望版面極簡，可採方案 B（expander 預設展開）；若希望「對獎結果 + 開獎號碼」一次看完，採方案 A。

---

## 三、具體 UI 建議（綜整）

### 3.1 主流程（不變）

- 兩個按鈕：「對獎（最新一期）」「對獎（上一期）」→ 一鍵取得並對獎。  
- 對獎結果：一句摘要 + 中獎明細表（或「未中獎」）。

### 3.2 本期開獎號碼

- **改為「對獎後直接展示」**（方案 A）：  
  - 在對獎結果摘要與中獎明細表**下方**，常駐一小塊：  
    - 標題：「本期開獎號碼」  
    - 內容：特別獎、特獎、頭獎（號碼列）、領獎期限。  
  - 僅在「已跑過對獎」（session 有 lottery_draw）時顯示，無需再點 expander。  
- **若仍用 expander**：則「查看本期開獎號碼」改為 **expanded=True**，對獎後預設展開。

### 3.3 手動輸入開獎號碼

- **保留**，維持在 expander 內。  
- 標題改為：「**手動貼上開獎號碼（備用）**」  
- 說明一句：「當自動取得失敗或要對更早期別時，可至財政部開獎頁複製整頁貼上後解析並對獎。」

### 3.4 小結表

| 項目 | 建議 |
|------|------|
| 手動輸入開獎號碼 | **保留**，收合在 expander，標題與說明標註為「備用」。 |
| 本期開獎號碼 | **應展示**；對獎後在結果區下方直接顯示一小塊，或 expander 預設展開。 |

---

## 四、實作選項（對應程式）

- **開獎號碼展示**：  
  - 若採「直接展示」：在 `lottery_last_checked` 區塊下方，若存在 `lottery_draw`，則輸出固定區塊「本期開獎號碼：特別獎 xxx、特獎 xxx、頭獎 xxx, xxx, xxx；領獎期限至 …」。  
  - 若採「expander 預設展開」：將「查看本期開獎號碼」之 `expanded=False` 改為 `expanded=True`（且僅在有 `lottery_draw` 時顯示該 expander）。  
- **手動區塊**：維持 expander，標題改為「手動貼上開獎號碼（備用）」，區塊內補上一句說明即可。
