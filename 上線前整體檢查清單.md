# 上線前整體檢查清單

**日期**：2026-02-12  
**應用**：上班族小工具（發票報帳・辦公小幫手）  
**部署環境**：VPS（騰訊雲 43.160.229.153）

---

## 一、程式架構總覽

### 1.1 核心檔案

| 檔案 | 說明 |
|------|------|
| `app.py` | 主程式（發票、登入、AI 工具） |
| `pdf_converter.py` | PDF 萬能轉換模組 |
| `pages/1_🛡️_Google登錄診斷工具.py` | 獨立頁面 |
| `templates/invoice_pdf.html` | PDF 模板（目前未接主程式） |
| `premium_dark.css` | 主題樣式 |
| `NotoSansTC-Regular.ttf` | 字型 |

### 1.2 設定檔

| 檔案 | 說明 |
|------|------|
| `requirements.txt` | Python 依賴（Streamlit Cloud 精簡版） |
| `requirements-server.txt` | 伺服器完整依賴（含 pdf2docx、google-cloud-speech） |
| `.streamlit/secrets.toml` | 金鑰與 OAuth（勿提交 Git） |
| `packages.txt` | 系統依賴 poppler（Streamlit Cloud 用） |

### 1.3 已排除於 Git（.gitignore）

- `.streamlit/`、`secrets.toml`
- `*.db`、`invoice_images/`
- `.env`、`venv/`
- `*.log`

---

## 二、功能模組清單

| 模組 | 狀態 | 依賴 |
|------|------|------|
| 📑 發票報帳小秘笈 | ✅ 已上線 | GEMINI_API_KEY、pymupdf |
| ⚖️ AI 合約比對 | ✅ 已上線 | GEMINI_API_KEY |
| 📄 PDF 萬能轉換工具 | ✅ 已上線 | pdfplumber、python-pptx、pdf2image、pdf2docx、poppler |
| 📅 AI 會議精華 | ✅ 已上線 | GEMINI_API_KEY（錄音轉錄可選 google-cloud-speech） |
| 🛡️ Google 登錄診斷工具 | ✅ 已上線 | secrets 中 [google_auth] |
| 📧 AI 客服小秘 | ⏳ 佔位中 | - |

### PDF 轉換細項

| 轉換 | 狀態 | 備註 |
|------|------|------|
| PDF → Excel | ✅ | pdfplumber |
| PDF → PPT | ✅ | python-pptx + pdf2image（需 poppler） |
| PDF → 圖片 ZIP | ✅ | pdf2image（需 poppler） |
| PDF → Word | ✅ | pdf2docx（伺服器已安裝） |
| PDF → Word（AI OCR） | ✅ | 掃描檔用，需 GEMINI_API_KEY |

---

## 三、上線前必做檢查

### 3.1 安全與機密

- [ ] **secrets.toml** 未提交 Git，僅存於伺服器
- [ ] **GEMINI_API_KEY** 已正確設定
- [ ] 無硬編碼密碼、API Key
- [ ] 無測試帳號、調試開關

### 3.2 部署環境

- [ ] 伺服器已安裝 `poppler-utils`（PDF 轉換）
- [ ] Python 套件完整（`requirements-server.txt` 或 `requirements.txt` + 補裝）
- [ ] 安全組已開放 8501 埠
- [ ] 應用以 nohup 或 systemd 背景運行

### 3.3 功能驗證

- [ ] 註冊 → 登入 → 發票 OCR → 檢視/編輯 → 導出 CSV/Excel/PDF
- [ ] 瀏覽器完整重新整理（F5）後，檢查是否返回登入頁面
- [ ] 發票對獎（本期/上期）
- [ ] PDF 轉 Excel、PPT、圖片、Word
- [ ] AI 會議精華（貼上逐字稿或上傳錄音）
- [ ] AI 合約比對
- [ ] Session 逾時後需重新登入
- [ ] 登出後無法存取發票資料

### 3.4 資料與備份

- [ ] `data/`、`invoice_images/`、`invoices_v2.db` 路徑正確
- [ ] 規劃定期備份（可選）

---

## 四、建議優化（非阻擋）

| 項目 | 說明 |
|------|------|
| bcrypt | 生產環境可加 `bcrypt>=4.0.0` 強化密碼雜湊 |
| HTTPS | 設定 Nginx + Certbot 綁定域名 |
| 開機自啟 | 設定 systemd 服務 |
| README | 更新為目前功能說明（發票、PDF、AI 工具） |

---

## 五、快速驗證指令（伺服器）

```bash
# 檢查應用運行
ps aux | grep streamlit

# 檢查埠號監聽
ss -tlnp | grep 8501

# 檢查健康
curl http://localhost:8501/_stcore/health

# 查看日誌
tail -50 /root/streamlit-ocr-app/streamlit.log
```

---

## 六、上線結論

完成上述「三、上線前必做檢查」後，即可正式對外提供服務。

**目前部署**：http://43.160.229.153:8501

---

**文件版本**：v1.0  
**參考**：上架前測試與檢查報告_20260207.md、部署到VPS指南.md
